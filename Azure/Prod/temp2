Refreshing Terraform state in-memory prior to plan...
The refreshed state will be used to calculate this plan, but will not be
persisted to local or remote state storage.

azurerm_subnet_network_security_group_association.gateway: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway]
azurerm_network_security_rule.bjss: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowBjssVpn]
azurerm_network_security_rule.bwp: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowBwpGovIp]
data.azurerm_key_vault_secret.kv-bpass: Refreshing state...
data.azurerm_key_vault_secret.kv-secret: Refreshing state...
azurerm_resource_group.acr: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-acr]
data.azurerm_key_vault_secret.kv-buser: Refreshing state...
azurerm_resource_group.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec]
data.azurerm_key_vault_secret.kv-sp-user: Refreshing state...
data.azurerm_key_vault_secret.kv-appid: Refreshing state...
data.azurerm_key_vault_secret.kv-sqlpass: Refreshing state...
data.azurerm_key_vault_secret.kv-tenant: Refreshing state...
azurerm_resource_group.aks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-aks]
data.azurerm_key_vault_secret.kv-sqladmins: Refreshing state...
azurerm_resource_group.ehubukw: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-ukw]
azurerm_resource_group.log_analytics: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-la]
azurerm_resource_group.storage: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa]
data.azurerm_key_vault_secret.kv-objectid: Refreshing state...
azurerm_resource_group.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri]
data.azurerm_key_vault_secret.kv-subscription: Refreshing state...
data.azurerm_key_vault_secret.kv-spn: Refreshing state...
data.azurerm_key_vault_secret.kv-sqluser: Refreshing state...
azurerm_resource_group.ehubuks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-uks]
data.azurerm_key_vault_secret.kv-sp-pass: Refreshing state...
azurerm_resource_group.vnet: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet]
azurerm_management_lock.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_management_lock.acr: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-acr/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_container_registry.acr: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-acr/providers/Microsoft.ContainerRegistry/registries/gpitfuturesprodacr]
azurerm_management_lock.aks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-aks/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_management_lock.ehubukw: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-ukw/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_eventhub_namespace.ehubukw: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-ukw/providers/Microsoft.EventHub/namespaces/gpitfutures-prod-ensukw]
azurerm_log_analytics_workspace.workspace: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-la/providers/microsoft.operationalinsights/workspaces/gpitfutures-prod-logs]
azurerm_management_lock.logs: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-la/providers/Microsoft.Authorization/locks/az_mgm_lock_ehub_uks]
azurerm_management_lock.storage: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_storage_account.public: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsapub]
azurerm_storage_account.sqlukw: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqlukw]
azurerm_storage_account.sqluks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqluks]
azurerm_storage_account.private: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsapri]
azurerm_management_lock.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_eventhub_namespace.ehubuks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-uks/providers/Microsoft.EventHub/namespaces/gpitfutures-prod-ensuks]
azurerm_management_lock.ehubuks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-uks/providers/Microsoft.Authorization/locks/az_mgm_lock_ehub_uks]
azurerm_network_security_group.splunk: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-splunk]
azurerm_management_lock.vnet: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Authorization/locks/az_mgm_lock_aks]
azurerm_virtual_network.vnet: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet]
azurerm_network_security_group.gateway: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway]
azurerm_public_ip.pub-Pip: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/publicIPAddresses/gpitfutures-prod-pip-pub]
azurerm_public_ip.pri-Pip: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/publicIPAddresses/gpitfutures-prod-pip-pri]
azurerm_eventhub.ehubukw: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-ukw/providers/Microsoft.EventHub/namespaces/gpitfutures-prod-ensukw/eventhubs/gpitfutures-prod-ehubukw]
azurerm_network_security_rule.DevOps: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowAzureDevOps]
azurerm_network_security_rule.Azure: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowAzureInfrastructurePorts]
azurerm_subnet.vm: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-vm]
azurerm_subnet.gateway: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway]
azurerm_subnet.splunk: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-splunk]
azurerm_subnet.aks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-aks]
azurerm_subnet.bastion: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-bastion]
azurerm_subnet.ehub: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-ehub]
azurerm_sql_server.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri]
azurerm_sql_server.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-sec]
azurerm_application_gateway.pri-AppGate: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri]
azurerm_application_gateway.pub-AppGate: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub]
azurerm_kubernetes_cluster.aks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-aks/providers/Microsoft.ContainerService/managedClusters/gpitfutures-prod-aks]
azurerm_sql_firewall_rule.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/firewallRules/azure_services]
azurerm_sql_active_directory_administrator.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/administrators/activeDirectory]
azurerm_sql_database.sql-bapi-pub: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/databases/gpitfutures-prod-db-bapi-private]
azurerm_sql_database.sql-bapi-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/databases/gpitfutures-prod-db-bapi-public]
azurerm_sql_active_directory_administrator.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-sec/administrators/activeDirectory]
azurerm_sql_firewall_rule.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-sec/firewallRules/azure_services]
azurerm_storage_container.pri-web: Refreshing state... [id=https://gpitfuturesprodsapri.blob.core.windows.net/$web]
azurerm_storage_container.pri-documents: Refreshing state... [id=https://gpitfuturesprodsapri.blob.core.windows.net/documents]
azurerm_advanced_threat_protection.bc-sql-sec: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqlukw/providers/Microsoft.Security/advancedThreatProtectionSettings/current]
azurerm_storage_container.sqlukw: Refreshing state... [id=https://gpitfuturesprodsasqlukw.blob.core.windows.net/sqlauditlogs]
azurerm_storage_container.sqluks: Refreshing state... [id=https://gpitfuturesprodsasqluks.blob.core.windows.net/sqlauditlogs]
azurerm_advanced_threat_protection.bc-sql-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqluks/providers/Microsoft.Security/advancedThreatProtectionSettings/current]
azurerm_sql_failover_group.sql-bapi-pub: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/failoverGroups/gpitfutures-prod-sql-fog1]
azurerm_storage_container.pub-web: Refreshing state... [id=https://gpitfuturesprodsapub.blob.core.windows.net/$web]
azurerm_storage_container.pub-documents: Refreshing state... [id=https://gpitfuturesprodsapub.blob.core.windows.net/documents]
azurerm_sql_failover_group.sql-bapi-pri: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri/failoverGroups/gpitfutures-prod-sql-fog]
azurerm_eventhub.ehubuks: Refreshing state... [id=/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-ehub-uks/providers/Microsoft.EventHub/namespaces/gpitfutures-prod-ensuks/eventhubs/gpitfutures-prod-ehubuks]

------------------------------------------------------------------------

An execution plan has been generated and is shown below.
Resource actions are indicated with the following symbols:
  + create
  ~ update in-place
  - destroy
-/+ destroy and then create replacement

Terraform will perform the following actions:

  # azurerm_advanced_threat_protection.private will be created
  + resource "azurerm_advanced_threat_protection" "private" {
      + enabled            = true
      + id                 = (known after apply)
      + target_resource_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsapri"
    }

  # azurerm_advanced_threat_protection.public will be created
  + resource "azurerm_advanced_threat_protection" "public" {
      + enabled            = true
      + id                 = (known after apply)
      + target_resource_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsapub"
    }

  # azurerm_advanced_threat_protection.sqluks will be created
  + resource "azurerm_advanced_threat_protection" "sqluks" {
      + enabled            = true
      + id                 = (known after apply)
      + target_resource_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqluks"
    }

  # azurerm_advanced_threat_protection.sqlukw will be created
  + resource "azurerm_advanced_threat_protection" "sqlukw" {
      + enabled            = true
      + id                 = (known after apply)
      + target_resource_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sa/providers/Microsoft.Storage/storageAccounts/gpitfuturesprodsasqlukw"
    }

  # azurerm_application_gateway.pri-AppGate will be updated in-place
  ~ resource "azurerm_application_gateway" "pri-AppGate" {
        disabled_ssl_protocols = []
        enable_http2           = false
        id                     = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri"
        location               = "uksouth"
        name                   = "gpitfutures-prod-appgw-pri"
        resource_group_name    = "gpitfutures-prod-rg-vnet"
        tags                   = {
            "last-updated-by-k8s-ingress" = "2020-04-14 08:10:25.997943095 +0000 UTC m=+262713.622071797"
            "managed-by-k8s-ingress"      = "1.0.0/cd166d64/2019-11-07-22:55T+0000"
        }
        zones                  = []

        backend_address_pool {
            fqdn_list       = []
            fqdns           = []
            id              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/defaultaddresspool"
            ip_address_list = []
            ip_addresses    = []
            name            = "defaultaddresspool"
        }
        backend_address_pool {
            fqdn_list       = []
            fqdns           = []
            id              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/pool-buyingcatalogue-private-marketingpage-3002-bp-3002"
            ip_address_list = [
                "10.100.49.13",
            ]
            ip_addresses    = [
                "10.100.49.13",
            ]
            name            = "pool-buyingcatalogue-private-marketingpage-3002-bp-3002"
        }
        backend_address_pool {
            fqdn_list       = []
            fqdns           = []
            id              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/bepool-buyingcatalogue-private-publicbrowse"
            ip_address_list = [
                "10.100.49.27",
            ]
            ip_addresses    = [
                "10.100.49.27",
            ]
            name            = "bepool-buyingcatalogue-private-publicbrowse"
        }
        backend_address_pool {
            fqdn_list       = []
            fqdns           = []
            id              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/bepool-buyingcatalogue-private-marketingpage"
            ip_address_list = [
                "10.100.49.13",
            ]
            ip_addresses    = [
                "10.100.49.13",
            ]
            name            = "bepool-buyingcatalogue-private-marketingpage"
        }

        backend_http_settings {
            affinity_cookie_name                = "ApplicationGatewayAffinity"
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp"
            name                                = "bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp"
            pick_host_name_from_backend_address = false
            port                                = 3002
            probe_id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/pb-buyingcatalogue-private-marketingpage-3002-buyingcatalogue-pri-mp"
            probe_name                          = "pb-buyingcatalogue-private-marketingpage-3002-buyingcatalogue-pri-mp"
            protocol                            = "Http"
            request_timeout                     = 30
            trusted_root_certificate_names      = []
        }
        backend_http_settings {
            affinity_cookie_name                = "ApplicationGatewayAffinity"
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb"
            name                                = "bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb"
            pick_host_name_from_backend_address = false
            port                                = 3000
            probe_id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/pb-buyingcatalogue-private-publicbrowse-3000-buyingcatalogue-pri-pb"
            probe_name                          = "pb-buyingcatalogue-private-publicbrowse-3000-buyingcatalogue-pri-pb"
            protocol                            = "Http"
            request_timeout                     = 30
            trusted_root_certificate_names      = []
        }
        backend_http_settings {
            affinity_cookie_name                = "ApplicationGatewayAffinity"
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/defaulthttpsetting"
            name                                = "defaulthttpsetting"
            pick_host_name_from_backend_address = false
            port                                = 80
            probe_id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/defaultprobe-Http"
            probe_name                          = "defaultprobe-Http"
            protocol                            = "Http"
            request_timeout                     = 30
            trusted_root_certificate_names      = []
        }
        backend_http_settings {
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/http-buyingcatalogue-private-publicbrowse-3000"
            name                                = "http-buyingcatalogue-private-publicbrowse-3000"
            pick_host_name_from_backend_address = false
            port                                = 3000
            protocol                            = "Http"
            request_timeout                     = 20
            trusted_root_certificate_names      = []
        }
        backend_http_settings {
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/http-buyingcatalogue-private-marketingpage-3002"
            name                                = "http-buyingcatalogue-private-marketingpage-3002"
            pick_host_name_from_backend_address = false
            port                                = 3002
            protocol                            = "Http"
            request_timeout                     = 20
            trusted_root_certificate_names      = []
        }

        frontend_ip_configuration {
            id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            name                          = "gpitfutures-prod-appgw-feip"
            private_ip_address_allocation = "Dynamic"
            public_ip_address_id          = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/publicIPAddresses/gpitfutures-prod-pip-pri"
        }

        frontend_port {
            id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendPorts/gpitfutures-prod-appgw-feport"
            name = "gpitfutures-prod-appgw-feport"
            port = 80
        }
        frontend_port {
            id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendPorts/port_443"
            name = "port_443"
            port = 443
        }

      ~ gateway_ip_configuration {
            id        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/gatewayIPConfigurations/gpitfutures-gwip-pri"
            name      = "gpitfutures-gwip-pri"
          ~ subnet_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway" -> (known after apply)
        }

        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendPorts/gpitfutures-prod-appgw-feport"
            frontend_port_name             = "gpitfutures-prod-appgw-feport"
            host_name                      = "buyingcatalogueprodprivate.uksouth.cloudapp.azure.com"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/httpListeners/listener-buyingcatalogueprodprivate.uksouth.cloudapp.azure.com-80"
            name                           = "listener-buyingcatalogueprodprivate.uksouth.cloudapp.azure.com-80"
            protocol                       = "Http"
            require_sni                    = false
        }
        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendPorts/gpitfutures-prod-appgw-feport"
            frontend_port_name             = "gpitfutures-prod-appgw-feport"
            host_name                      = "private.buyingcatalogue.digital.nhs.uk"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/httpListeners/listener-private.buyingcatalogue.digital.nhs.uk-80"
            name                           = "listener-private.buyingcatalogue.digital.nhs.uk-80"
            protocol                       = "Http"
            require_sni                    = false
        }
        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/frontendPorts/port_443"
            frontend_port_name             = "port_443"
            host_name                      = "private.buyingcatalogue.digital.nhs.uk"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/httpListeners/listener-private.buyingcatalogue.digital.nhs.uk-443"
            name                           = "listener-private.buyingcatalogue.digital.nhs.uk-443"
            protocol                       = "Https"
            require_sni                    = true
            ssl_certificate_id             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/sslCertificates/listener-private.buyingcatalogue.digital.nhs.uk-443vaultCert"
            ssl_certificate_name           = "listener-private.buyingcatalogue.digital.nhs.uk-443vaultCert"
        }

        identity {
            identity_ids = [
                "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-aks/providers/Microsoft.ManagedIdentity/userAssignedIdentities/gpitfutures-prod-aad-id",
            ]
            type         = "UserAssigned"
        }

        probe {
            host                                      = "localhost"
            id                                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/defaultprobe-Http"
            interval                                  = 30
            minimum_servers                           = 0
            name                                      = "defaultprobe-Http"
            path                                      = "/"
            pick_host_name_from_backend_http_settings = false
            protocol                                  = "Http"
            timeout                                   = 30
            unhealthy_threshold                       = 3

            match {
                status_code = [
                    "200-399",
                ]
            }
        }
        probe {
            host                                      = "localhost"
            id                                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/defaultprobe-Https"
            interval                                  = 30
            minimum_servers                           = 0
            name                                      = "defaultprobe-Https"
            path                                      = "/"
            pick_host_name_from_backend_http_settings = false
            protocol                                  = "Https"
            timeout                                   = 30
            unhealthy_threshold                       = 3

            match {
                status_code = [
                    "200-399",
                ]
            }
        }
        probe {
            host                                      = "localhost"
            id                                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/pb-buyingcatalogue-private-marketingpage-3002-buyingcatalogue-pri-mp"
            interval                                  = 30
            minimum_servers                           = 0
            name                                      = "pb-buyingcatalogue-private-marketingpage-3002-buyingcatalogue-pri-mp"
            path                                      = "/marketing/"
            pick_host_name_from_backend_http_settings = false
            protocol                                  = "Http"
            timeout                                   = 30
            unhealthy_threshold                       = 3

            match {
                status_code = [
                    "200-399",
                ]
            }
        }
        probe {
            host                                      = "localhost"
            id                                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/probes/pb-buyingcatalogue-private-publicbrowse-3000-buyingcatalogue-pri-pb"
            interval                                  = 30
            minimum_servers                           = 0
            name                                      = "pb-buyingcatalogue-private-publicbrowse-3000-buyingcatalogue-pri-pb"
            path                                      = "/"
            pick_host_name_from_backend_http_settings = false
            protocol                                  = "Http"
            timeout                                   = 30
            unhealthy_threshold                       = 3

            match {
                status_code = [
                    "200-399",
                ]
            }
        }

        request_routing_rule {
            http_listener_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/httpListeners/listener-private.buyingcatalogue.digital.nhs.uk-80"
            http_listener_name = "listener-private.buyingcatalogue.digital.nhs.uk-80"
            id                 = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/requestRoutingRules/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80"
            name               = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80"
            rule_type          = "PathBasedRouting"
            url_path_map_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80"
            url_path_map_name  = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80"
        }
        request_routing_rule {
            http_listener_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/httpListeners/listener-private.buyingcatalogue.digital.nhs.uk-443"
            http_listener_name = "listener-private.buyingcatalogue.digital.nhs.uk-443"
            id                 = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/requestRoutingRules/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443"
            name               = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443"
            rule_type          = "PathBasedRouting"
            url_path_map_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443"
            url_path_map_name  = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443"
        }

        sku {
            capacity = 1
            name     = "WAF_v2"
            tier     = "WAF_v2"
        }

      - ssl_certificate {
          - id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/sslCertificates/listener-private.buyingcatalogue.digital.nhs.uk-443vaultCert" -> null
          - name = "listener-private.buyingcatalogue.digital.nhs.uk-443vaultCert" -> null
        }

        ssl_policy {
            cipher_suites      = []
            disabled_protocols = []
            policy_name        = "AppGwSslPolicy20170401S"
            policy_type        = "Predefined"
        }

      - url_path_map {
          - default_backend_address_pool_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/bepool-buyingcatalogue-private-publicbrowse" -> null
          - default_backend_address_pool_name  = "bepool-buyingcatalogue-private-publicbrowse" -> null
          - default_backend_http_settings_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb" -> null
          - default_backend_http_settings_name = "bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb" -> null
          - id                                 = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80" -> null
          - name                               = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80" -> null

          - path_rule {
              - backend_address_pool_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/bepool-buyingcatalogue-private-marketingpage" -> null
              - backend_address_pool_name  = "bepool-buyingcatalogue-private-marketingpage" -> null
              - backend_http_settings_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp" -> null
              - backend_http_settings_name = "bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp" -> null
              - id                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-80/pathRules/rrr-marketingpage-private.buyingcatalogue.digital.nhs.uk-80" -> null
              - name                       = "rrr-marketingpage-private.buyingcatalogue.digital.nhs.uk-80" -> null
              - paths                      = [
                  - "/marketing/*",
                ] -> null
            }
        }
      - url_path_map {
          - default_backend_address_pool_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/bepool-buyingcatalogue-private-publicbrowse" -> null
          - default_backend_address_pool_name  = "bepool-buyingcatalogue-private-publicbrowse" -> null
          - default_backend_http_settings_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb" -> null
          - default_backend_http_settings_name = "bp-buyingcatalogue-private-publicbrowse-3000-3000-buyingcatalogue-pri-pb" -> null
          - id                                 = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443" -> null
          - name                               = "rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443" -> null

          - path_rule {
              - backend_address_pool_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendAddressPools/pool-buyingcatalogue-private-marketingpage-3002-bp-3002" -> null
              - backend_address_pool_name  = "pool-buyingcatalogue-private-marketingpage-3002-bp-3002" -> null
              - backend_http_settings_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/backendHttpSettingsCollection/bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp" -> null
              - backend_http_settings_name = "bp-buyingcatalogue-private-marketingpage-3002-3002-buyingcatalogue-pri-mp" -> null
              - id                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pri/urlPathMaps/rrr-publicbrowse-private.buyingcatalogue.digital.nhs.uk-443/pathRules/rrr-marketingpage-private.buyingcatalogue.digital.nhs.uk-443" -> null
              - name                       = "rrr-marketingpage-private.buyingcatalogue.digital.nhs.uk-443" -> null
              - paths                      = [
                  - "/marketing/*",
                ] -> null
            }
        }
    }

  # azurerm_application_gateway.pub-AppGate will be updated in-place
  ~ resource "azurerm_application_gateway" "pub-AppGate" {
        disabled_ssl_protocols = []
        enable_http2           = false
        id                     = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub"
        location               = "uksouth"
        name                   = "gpitfutures-prod-appgw-pub"
        resource_group_name    = "gpitfutures-prod-rg-vnet"
        tags                   = {
            "last-updated-by-k8s-ingress" = "2020-04-11 08:15:39.98606345 +0000 UTC m=+3823.365728695"
            "managed-by-k8s-ingress"      = "1.0.0/cd166d64/2019-11-07-22:55T+0000"
        }
        zones                  = []

        backend_address_pool {
            fqdn_list       = []
            fqdns           = []
            id              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/backendAddressPools/bepool-buyingcatalogue-public-publicbrowse"
            ip_address_list = [
                "10.100.49.14",
            ]
            ip_addresses    = [
                "10.100.49.14",
            ]
            name            = "bepool-buyingcatalogue-public-publicbrowse"
        }

        backend_http_settings {
            affinity_cookie_name                = "ApplicationGatewayAffinity"
            cookie_based_affinity               = "Disabled"
            id                                  = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/backendHttpSettingsCollection/http-buyingcatalogue-public-publicbrowse-3000"
            name                                = "http-buyingcatalogue-public-publicbrowse-3000"
            pick_host_name_from_backend_address = false
            port                                = 3000
            probe_id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/probes/healthprobe-publicbrowse-public-3000"
            probe_name                          = "healthprobe-publicbrowse-public-3000"
            protocol                            = "Http"
            request_timeout                     = 20
            trusted_root_certificate_names      = []
        }

        frontend_ip_configuration {
            id                            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            name                          = "gpitfutures-prod-appgw-feip"
            private_ip_address_allocation = "Dynamic"
            public_ip_address_id          = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/publicIPAddresses/gpitfutures-prod-pip-pub"
        }

        frontend_port {
            id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendPorts/gpitfutures-prod-appgw-feport"
            name = "gpitfutures-prod-appgw-feport"
            port = 80
        }
        frontend_port {
            id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendPorts/port_443"
            name = "port_443"
            port = 443
        }

        gateway_ip_configuration {
            id        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/gatewayIPConfigurations/gpitfutures-gwip-pub"
            name      = "gpitfutures-gwip-pub"
            subnet_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway"
        }

        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendPorts/gpitfutures-prod-appgw-feport"
            frontend_port_name             = "gpitfutures-prod-appgw-feport"
            host_name                      = "buyingcatalogueprodpublic.uksouth.cloudapp.azure.com"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogueprodpublic.uksouth.cloudapp.azure.com-80"
            name                           = "listener-buyingcatalogueprodpublic.uksouth.cloudapp.azure.com-80"
            protocol                       = "Http"
            require_sni                    = false
        }
        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendPorts/gpitfutures-prod-appgw-feport"
            frontend_port_name             = "gpitfutures-prod-appgw-feport"
            host_name                      = "buyingcatalogue.digital.nhs.uk"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogue.digital.nhs.uk-80"
            name                           = "listener-buyingcatalogue.digital.nhs.uk-80"
            protocol                       = "Http"
            require_sni                    = false
        }
        http_listener {
            frontend_ip_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendIPConfigurations/gpitfutures-prod-appgw-feip"
            frontend_ip_configuration_name = "gpitfutures-prod-appgw-feip"
            frontend_port_id               = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/frontendPorts/port_443"
            frontend_port_name             = "port_443"
            host_name                      = "buyingcatalogue.digital.nhs.uk"
            id                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogue.digital.nhs.uk-443"
            name                           = "listener-buyingcatalogue.digital.nhs.uk-443"
            protocol                       = "Https"
            require_sni                    = true
            ssl_certificate_id             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/sslCertificates/listener-buyingcatalogue.digital.nhs.uk-443vaultCert"
            ssl_certificate_name           = "listener-buyingcatalogue.digital.nhs.uk-443vaultCert"
        }

        identity {
            identity_ids = [
                "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-aks/providers/Microsoft.ManagedIdentity/userAssignedIdentities/gpitfutures-prod-aad-id",
            ]
            type         = "UserAssigned"
        }

        probe {
            host                                      = "buyingcatalogue.digital.nhs.uk"
            id                                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/probes/healthprobe-publicbrowse-public-3000"
            interval                                  = 30
            minimum_servers                           = 0
            name                                      = "healthprobe-publicbrowse-public-3000"
            path                                      = "/"
            pick_host_name_from_backend_http_settings = false
            protocol                                  = "Http"
            timeout                                   = 30
            unhealthy_threshold                       = 3

            match {
                status_code = [
                    "200-399",
                ]
            }
        }

      - redirect_configuration {
          - id                   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/redirectConfigurations/rrr-buyingcatalogue.digital.nhs.uk-80" -> null
          - include_path         = true -> null
          - include_query_string = true -> null
          - name                 = "rrr-buyingcatalogue.digital.nhs.uk-80" -> null
          - redirect_type        = "Found" -> null
          - target_listener_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogue.digital.nhs.uk-443" -> null
          - target_listener_name = "listener-buyingcatalogue.digital.nhs.uk-443" -> null
        }

        request_routing_rule {
            backend_address_pool_id    = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/backendAddressPools/bepool-buyingcatalogue-public-publicbrowse"
            backend_address_pool_name  = "bepool-buyingcatalogue-public-publicbrowse"
            backend_http_settings_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/backendHttpSettingsCollection/http-buyingcatalogue-public-publicbrowse-3000"
            backend_http_settings_name = "http-buyingcatalogue-public-publicbrowse-3000"
            http_listener_id           = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogue.digital.nhs.uk-443"
            http_listener_name         = "listener-buyingcatalogue.digital.nhs.uk-443"
            id                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/requestRoutingRules/rrr-buyingcatalogue.digital.nhs.uk-443"
            name                       = "rrr-buyingcatalogue.digital.nhs.uk-443"
            rule_type                  = "Basic"
        }
        request_routing_rule {
            http_listener_id            = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/httpListeners/listener-buyingcatalogue.digital.nhs.uk-80"
            http_listener_name          = "listener-buyingcatalogue.digital.nhs.uk-80"
            id                          = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/requestRoutingRules/rrr-buyingcatalogue.digital.nhs.uk-80"
            name                        = "rrr-buyingcatalogue.digital.nhs.uk-80"
            redirect_configuration_id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/redirectConfigurations/rrr-buyingcatalogue.digital.nhs.uk-80"
            redirect_configuration_name = "rrr-buyingcatalogue.digital.nhs.uk-80"
            rule_type                   = "Basic"
        }

        sku {
            capacity = 1
            name     = "WAF_v2"
            tier     = "WAF_v2"
        }

      - ssl_certificate {
          - id   = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/applicationGateways/gpitfutures-prod-appgw-pub/sslCertificates/listener-buyingcatalogue.digital.nhs.uk-443vaultCert" -> null
          - name = "listener-buyingcatalogue.digital.nhs.uk-443vaultCert" -> null
        }

        ssl_policy {
            cipher_suites      = []
            disabled_protocols = []
            policy_name        = "AppGwSslPolicy20170401S"
            policy_type        = "Predefined"
        }

      - waf_configuration {
          - enabled                  = true -> null
          - file_upload_limit_mb     = 100 -> null
          - firewall_mode            = "Detection" -> null
          - max_request_body_size_kb = 128 -> null
          - request_body_check       = true -> null
          - rule_set_type            = "OWASP" -> null
          - rule_set_version         = "3.0" -> null
        }
    }

  # azurerm_bastion_host.bastion will be created
  + resource "azurerm_bastion_host" "bastion" {
      + dns_name            = (known after apply)
      + id                  = (known after apply)
      + location            = "uksouth"
      + name                = "gpitfutures-prod-bastion"
      + resource_group_name = "gpitfutures-prod-rg-bastion"
      + tags                = {
          + "environment" = "prod"
        }

      + ip_configuration {
          + name                 = "gpitfutures-bastionip"
          + public_ip_address_id = (known after apply)
          + subnet_id            = (known after apply)
        }
    }

  # azurerm_eventhub.ehubukw will be created
  + resource "azurerm_eventhub" "ehubukw" {
      + id                  = (known after apply)
      + message_retention   = 1
      + name                = "gpitfutures-prod-ehubukw"
      + namespace_name      = "gpitfutures-prod-ensukw"
      + partition_count     = 2
      + partition_ids       = (known after apply)
      + resource_group_name = "gpitfutures-prod-rg-ehub-ukw"
    }

  # azurerm_eventhub_namespace.ehubukw will be created
  + resource "azurerm_eventhub_namespace" "ehubukw" {
      + auto_inflate_enabled                = false
      + capacity                            = 2
      + default_primary_connection_string   = (sensitive value)
      + default_primary_key                 = (sensitive value)
      + default_secondary_connection_string = (sensitive value)
      + default_secondary_key               = (sensitive value)
      + id                                  = (known after apply)
      + kafka_enabled                       = (known after apply)
      + location                            = "ukwest"
      + maximum_throughput_units            = (known after apply)
      + name                                = "gpitfutures-prod-ensukw"
      + network_rulesets                    = (known after apply)
      + resource_group_name                 = "gpitfutures-prod-rg-ehub-ukw"
      + sku                                 = "Standard"
      + tags                                = {
          + "environment" = "prod"
        }
    }

  # azurerm_kubernetes_cluster.aks will be updated in-place
  ~ resource "azurerm_kubernetes_cluster" "aks" {
        api_server_authorized_ip_ranges = []
        dns_prefix                      = "gpitfuturesprodaksdns"
      ~ enable_pod_security_policy      = false -> true
        fqdn                            = "gpitfuturesprodaksdns-03fbe41c.hcp.uksouth.azmk8s.io"
        id                              = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-aks/providers/Microsoft.ContainerService/managedClusters/gpitfutures-prod-aks"
        kube_admin_config               = []
        kube_config                     = [
            {
                client_certificate     = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUUvRENDQXVTZ0F3SUJBZ0lRWjd5UFM3dmFzOVJZMGFUVVVLcWxIVEFOQmdrcWhraUc5dzBCQVFzRkFEQU4KTVFzd0NRWURWUVFERXdKallUQWVGdzB5TURBek1URXdPVFF5TXpKYUZ3MHlNakF6TVRFd09UVXlNekphTURBeApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1SVXdFd1lEVlFRREV3eHRZWE4wWlhKamJHbGxiblF3CmdnSWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUNEd0F3Z2dJS0FvSUNBUUN3Z3ZZTVd6c2VONUxFZGVFWE5SU0kKQWpxT3NSdnREWGRHYXZUakk1dHMwQVFoYkQ3M3NmTi9uaFErTngyTWxjejNkWmhGTFo1M2kwS3ZKbllkK2t0bgpMck44SGRzSmNJaHpYVXVSVUQ5a1hoTUNxL21mK0xpRCthN0pVbjFsbWtIVDlCNVdwalJCUnhRVHV4NlROZ0QrCjZ0bWxaV0xjeTFZL2xITUVpeHliNlJkR1dLNlhFbmx5VCttVzRjdzY0Q0RjbTYzUWtBUW1pYWtiZXpHdVRucWUKQXlWc0VnNkd2ZGhBQXcrQkxORzZIMW82OVA1ZE55YXQ5L0htcGVic3k2dTZiR3JZTGptZldkcllUUTFIVC8wdApqU1Z2Q2FmbGt6RmI5b01UTy92SVFTakszTVpVV2h4WElRSC9zZzVpS3o4Uzd0dlVJczI3aWY2SytvTnZXVDdvClRoSFJDZXdDeFJUS0R2SmNiaDBiSWN4TnFJeWdaaDJHVjBhV3o4bnpHUHl3OFE1WHFsVGQyakpKZWZHRGRScVMKbG1kRFo5ZDdudG42VW5lN1YybHlPbXl1OGF0bDVJR25ic20rTms4OFhvN2k1R3VwdlJGbkRRQmJabzZYMmJDawpFaHA1Zy81RXZIRis0elZFRkVtTVpVRytRc1NORWdPSHpxL29GdjNrYkkzWEJ1YUFESyt6Y0RvVmJ5WTBPVVZOClFVMHJiRzEvcVhUaHNYMlo3U2Y4T0kwUXVuaklhVnhxK29qbzI4M2JJWXcyY1Fqa0M5Yjh4SVZRSHlYbmxEY04KeFU0cGx4TXBGYW5oenpuTDRRa3hWbXJDMXRBSGlSVFlwczlQVVBJdGJTT2haSHZQWTl0RkJyZDZUT1hXdFU4YgpXMklOeTdiTnF5Rm91OURCOTRKNE9RSURBUUFCb3pVd016QU9CZ05WSFE4QkFmOEVCQU1DQmFBd0V3WURWUjBsCkJBd3dDZ1lJS3dZQkJRVUhBd0l3REFZRFZSMFRBUUgvQkFJd0FEQU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FnRUEKQnk5dmNqRVV2YzMydm9CMFo4clR1S0V6NXdnMkJqSm8xSm1oZElydnVaY1o2VitlMHBoWTRPeFFqWFJtczArZwplMFd5dExuUm9mdnVzMm1OWTFlOEZWV1ZndFVrZVhxRHJFR2hPSzcvV2dzMXNpWVkxWkpUbW43dmZnUE1aMFlRCmhwS3g4eWR3VitwQk1hczJBNC9sZytjUUpyK1k0cTVQcjFFYnJCSzU4NkczV2t1dG1SRVJlZHY3ZVJORXZUdlEKdUsydllORFV2MS9ESlZ3d3R5MFdRWjFTMnQxMHkxa2NMVVRUeDdqdUErYlp2NUZYWVZ4OE9zN1hQZ255S3FTSwplSlBDOUJXQlpsTkJZU1BHRFZsVC9pKzNEeFMwSmo2OFY4Ky9ETVBtRnBaeDBTcmtYUWtOMTFwV3FyM29TMiswCk5wUnpuaDg3NjNOa3YvdFJtU0xkOVhNS2tDVVFTdTRZVEkzcVFNWTNGWDR0ckdERHJjVTgycEIzZVhKdjNCR3QKUm5UWHRwa05VSnluZCtoZ0pqUlUzNDV2T2Z4VWJEUlk0cUIxK2h3bkxvSlFqQWgyZUdDUlBzZkFpdlM4MkQ0Zgo0UkpPN2FZVm1jaXVOZnNYL0JSQ3R5a3BTbFJHRkU4bXBFU3JJOVF1YTZWWnlUL3BrYWU5eHE1dEhKdXFKRGlrCngvMXZPVHY0MUIrUDBoTkEwc1U2Q1JJcGE4MFc1Q3lEWDJaYkh0cVIydldQTFU5S1JTaVV6VGJtdFRUaWxQMmgKNjlaNU9UMlRoZS9jaTVoSEpNT2VCa0thZmYybFlwb0JJeUREQlBZZ0psNFpubTRqUUV4a1FhRENiSzd3N3ovagp1SENMaFpZak5KUjA5aWR5Q0pOYmJTSkFxZDhIZVZrVEQ1ajRUeTNqclNZPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
                client_key             = "LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlKSndJQkFBS0NBZ0VBc0lMMkRGczdIamVTeEhYaEZ6VVVpQUk2anJFYjdRMTNSbXIwNHlPYmJOQUVJV3crCjk3SHpmNTRVUGpjZGpKWE05M1dZUlMyZWQ0dENyeVoySGZwTFp5NnpmQjNiQ1hDSWMxMUxrVkEvWkY0VEFxdjUKbi9pNGcvbXV5Vko5WlpwQjAvUWVWcVkwUVVjVUU3c2VrellBL3VyWnBXVmkzTXRXUDVSekJJc2NtK2tYUmxpdQpseEo1Y2svcGx1SE1PdUFnM0p1dDBKQUVKb21wRzNzeHJrNTZuZ01sYkJJT2hyM1lRQU1QZ1N6UnVoOWFPdlQrClhUY21yZmZ4NXFYbTdNdXJ1bXhxMkM0NW4xbmEyRTBOUjAvOUxZMGxid21uNVpNeFcvYURFenY3eUVFb3l0ekcKVkZvY1Z5RUIvN0lPWWlzL0V1N2IxQ0xOdTRuK2l2cURiMWsrNkU0UjBRbnNBc1VVeWc3eVhHNGRHeUhNVGFpTQpvR1lkaGxkR2xzL0o4eGo4c1BFT1Y2cFUzZG95U1hueGczVWFrcFpuUTJmWGU1N1orbEozdTFkcGNqcHNydkdyClplU0JwMjdKdmpaUFBGNk80dVJycWIwUlp3MEFXMmFPbDltd3BCSWFlWVArUkx4eGZ1TTFSQlJKakdWQnZrTEUKalJJRGg4NnY2QmI5NUd5TjF3Ym1nQXl2czNBNkZXOG1ORGxGVFVGTksyeHRmNmwwNGJGOW1lMG4vRGlORUxwNAp5R2xjYXZxSTZOdk4yeUdNTm5FSTVBdlcvTVNGVUI4bDU1UTNEY1ZPS1pjVEtSV3A0Yzg1eStFSk1WWnF3dGJRCkI0a1UyS2JQVDFEeUxXMGpvV1I3ejJQYlJRYTNla3psMXJWUEcxdGlEY3UyemFzaGFMdlF3ZmVDZURrQ0F3RUEKQVFLQ0FnQkUrbmpDN1dnVjcrdklJTFRkQjk1RkpISFR6M3kxVDd6YjVQSmNUVTd3My8ydFBnc0JheVpZS2VPSgpTS3FnaE8zN2lwWDkrc3podEtkVG9Ua3BqK1dscGdkNEtvYXRrcStRUGRaSkxFNEpvQVhYMW5NUHcvZi9nelI5CjhtR1VzZ3FsbE5IQ1ZPTTQyMWtLT09iQzZxaks5ZVltRDQvcDd3Qitpam5FZmNTcFhSYStZK3VlbUJhanlIemwKZk1uOS9CWjdmODhXSVNHdUdiL2ZRRzV5eXJKNlM0cDFTRDByQk1lY2hGV3J5bU1QVkM5RHVQZ3FYMkliUERqcApSTTRRbmFzM2lDVGM1SHVhUFZnYmpVanlKRjB4VHVaaEZTbnF1bkhnbVY0eHh4QW0rdWZCRnpQZVJQU3NTL2JuCkFLTkVVOWdyUXZMZlhOWi9RbmNad3JwWWFrejlmd0RlS0pibkJkQ1ZXUXpJa3dKVGNhWk44WldYbklpN3FYOUQKa20yU1Uwc3Y1bVJYUFhHZHFiUGZRS2VsUXVUYmRYR1Z5ZzhXT210eEdGeUwrWjBrdnA2SHloamV3ZjZIZVNKMgpjbDAwcTI2dlVNeDZma3BVbkdUNmhBeXVCaG5aYVl3RXdKcTJiVHJlWVlRa1FqK1A0MFBKZ1VOVnFlMmwwcnpBClZkUVdqdGdmWGt0VDdkQmV5RUFNMWpTbHg3bDlFRFJlRjZCVVF3S2w3M0lQVkZ2b2s5ME84VXIranBYOG55QU4KbnVTY1BKZGhRQXZTUytybXUrVTBqK0NJamJwT3RPWjdlUGM2elJpZnV2YXBBNk0zbmI2N1VmaDB2dHJ1UjliQgpwNWxxNG1aQjhMSjRsWFlOcVFQSTdaMFlsZXo5b1ZjOGpFL2ZvdUpQZFluT1c2ejBmUUtDQVFFQTRxRXUxRWVPCitIQ1VtSkFRRVhBRmFZSURKaDZUYWZTUzdZM0hlZTJzNTIxNTJ5VGcvUGM5RFNPd1dHM3ZYZEI1by9HdVk2RkcKZnZva3VUUm96OFczckN2Ky9wS1RHVVJDYXdPblJIbE1FQnhhUUtzNHVHS3FsSG8vTmxIOE14Ny9lSEl4cHNhQwpSa2ZOalhaWERBUEorNkNFRVZhU0VTa1hQS0tvMWNrUWFkalZWbE9zOVlBYWhnNWE1NEk5M2t0T2I2aEpaN3JwCkd3TUZWSGV1TFk4YVp1b3pLcUtKNU8valpFYTNUWDIzQmY2eEcwNFp0dEhGdjdkWkloMXhuZ2crQlI4dlRlQVkKdUpzM1NWY1Zwalo4TUhVV1JCc1Z0bEJ6ZnNvSWV3NEFSUXZrVnVUUlhVY0gzeHZWTEhIWnYvY21YWTJEM21jagpXdWUvbXBuOThUSkF6d0tDQVFFQXgyTUhJYkM3SHg2MFh4OW1tbElVVktwZnM1VmFGS0xSQm9QcGRRNDhOWkFGCjNHZCtQSElaSi9adDB3SThJaVRDalJ6SEpnSXF3UCtZZDRmekZFbTJ2VndVMlpkaFoydDY2S0JIc2dsZHcxVm8KcGdobHk2RDdyU2ZGZy9CWERXVmdlYnliNXR2b3BVOUZQTSt3NGw3ZUJjR0dsdnBDek1NMlVscDJrenlrRlBQUgpSc0NGei9hcWMzUVl2eTZJYmN1M3B3N2RSOHRvbDhCdGRjaFVZUmh0alJiYmlnbytUVFBGbm9JZVgrdXhZb2xCCkZ3YWYxVDVJckZmWjJhQ1hVeC9TMk9rMncvV3V3STl1dVFvcVJGWXdScGVZQ08yaUV4QVNQb2ZUWHg4aTMzUFkKYzZiZlprZ1VsTnRKeXNKNDcxU1ZPQ2dRWWp5YW4xOHJ6aHRqZGhvb2R3S0NBUUFOdjhtZmgxZmRLcmRaS2lSUAphb1JwaWtHMnBsUTdNV05ZbGlscjlFZHhJdXNwcUdzZDdjSCtjaFBZeVpLa0ZtbkswSGJNQkpUS1QxSzdDYnJ5CklBU3NwVjZyQXlsNWR2S3dtMkFpZjFsbUFOSlk2Z3BlNVYyRDlJYXhQUGdZQWVGdDVUK3Q1bzB3eGxwcUlxdlYKUnNXU1JvSzhxb3ZpRHFRaVFad01uRTRxbmNVVG42LzJsUGNHK3dmNDA2WDlQb1Jic2RJQ1FReXpYdE9MOUZiVQozTUcxVExBZC9nNXZuVDRtYjBQZnA2amE3RURDYjFLUURObjZiNTB3dktpUDllQU5YMzczTW9sTmFkMUl6Y2U2CmRjUERETmQwK2srdTUrS1o1cGZ0SDBSVTdBdkdXY3Q1NVQxTkE5dEMvd1UrNkRlanBWcEN1KzhoTEw0ckd2eVYKRFg5eEFvSUJBRGl5aERpa1ZOR0luYW5lK0FJeURPMzJkTGhRWkFreU0xWXk5SlFBdEVaVzZoTytxanJ1QnhGQwpGZ0RHeGVxL29VTVhSOW9iQzZWT0NVRVVPNTh0UnZXWjFhUDZWQXhnbDliR25SeVhaVDVDYnp1bmI2cno0QjFoCkRkMXkzbzVFb2FaOFo2akNKK202SE9vcDlSYXArMkNQbzRJVE1DT2g3elNEM093SmRtOHUxZmZVanppUDMvQnMKdHd6R1lxMDJITWM0aHR2L2o0SjNpYWpRaW80QnNFVktscXN1Tm9FbGs3QjdONy8yK2I0WFlaYjJuMFM0TFZvMApzUklkaEdweXhqWkFPdjZHUW1jbllramtCeGpmbVdLNWdOWXBITWxtN0lremZudXlFdXlQdUtGS2RvUlRRdWNCClpINXZ4b3ZuOVhhK2pjb2hpYWFBSGFqQ1NRb3diZ2tDZ2dFQWFyK0xHVFFvdEJjZkVZbno4L3lTeTF3UDhhdG8Kb1VjOU1nU1ZhVFRXNXhQNE1hQWlLbGttc1Jhd0RmM0tqck90bnhOMmM3WUlLVGJjTXFScTVoYWtDcytGN0V5TwpZNzFTM2NuZDRJdG9ORmt5YUtFN2s1bm92VE5VSS91TWpNbHBDOGIxSzNjZnlvZHlSYXhzWkZ0bVhONld0MEY5CmRSdHBPL3V4TnpQV0RXWUs3SzMxaWh0Rzd3NVg2cEVtcFRKZndPUVppN0hMbytNWGZ5N3ZIcHFrTTZ3TjVsbEEKczFVNW15N25STlV1dmNHQUlaS01QQ3VjZnFPY0xQMWREKzY5eDVmdExJVVpQS3dlcytFakRIZEhVU09WYjhkVgoxOGtacC91dVUzcEM2ajJ5YWNiNUJ3d3V4M2RiaVNEb3lTeTUzTUM2MXcxTU1VenFxWmtkN2Z6MVFBPT0KLS0tLS1FTkQgUlNBIFBSSVZBVEUgS0VZLS0tLS0K"
                cluster_ca_certificate = "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUV5VENDQXJHZ0F3SUJBZ0lRSXFCRDB0cC8rNGsvQTYxQytnZHZWVEFOQmdrcWhraUc5dzBCQVFzRkFEQU4KTVFzd0NRWURWUVFERXdKallUQWdGdzB5TURBek1URXdPVFF5TXpKYUdBOHlNRFV3TURNeE1UQTVOVEl6TWxvdwpEVEVMTUFrR0ExVUVBeE1DWTJFd2dnSWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUNEd0F3Z2dJS0FvSUNBUUMzCmVaMU9TUlNoQ2oxdXVUWDREQzlYUEVXNFlvU0Y3S3VKMkZpNDJCNnd1YjVpZXdleForMGdYdGRBeEx0eDYxVXQKYURNWTRHYUtVNllCL2hJeGVaSTlpcEJQSjV1SitoUDVDa2NmNGMwRG9ycFUzUzVGajJyaGtwbmYzaTQweWg4SAp5L2RjanlyZGF0blphaEhpL2Q3NnNHcUZhdkhrSHEwT2FLTVlqdzZaQ3ROcTJ4V2RtWENrOTBiOFY2Y3NsSENICm4rNFUrdHBoei8rekV2UUhjeGdmejVtWXZySVVLYnliblZPckxkRlZKQ0M3NEtabDAwTkpYZTN0MEFsbjZ3TTIKMUxISEFPVlFrb3pmUEtzUGU1azNkOUVDZUlwNVhmcmtVOUFMVGI0VEFuQXlvVnppdWNHcXVObUovMHJmSTZwNwptbnJGYjd4ZlVsNWRwWFVWbXFYdnJyMDV3ZHpPanNCbW9icnBhamZMUHJxOTBvMXd2cnJZNXQxOUlmdXZSR01xCnk1aDhRd1FyemI1QTNTMC9mN2ZzTnBkYzEwT3hJV29waHJQWkpBTitXa0hkUUtUNnQ1QTJsNFV1aDY2ZVJVVE8KKzNieXFPL0ZlZkhJdEJ2ZGJUMXpqbUJjSTcwaWFPTUR2alVUWjZWWC9Xb2xWY2pTQzgzOHdKTUVHUUdwTksyZgo2Wlk1MzlTOERDaC9lOGhpQUxYUFI1OXdYVGRoUlU1c0RJTk9tbVBIQnhMVUxhTHBFT29xc2NSWERUcmNnbzhPCllYdTBrWGZhYWRjZWdsL1NYS2hyQ2NyWkFGWGE0N3lVOUZEQmZOcWt6YkVjeEk0dThyeWFlUUl5ZWI0aCtKVjQKdXE2S2RDOVRwWUpSWFQ1QUJHMzA2S0xjY1lrQ1ZKZmlMRzduS1lyVmNRSURBUUFCb3lNd0lUQU9CZ05WSFE4QgpBZjhFQkFNQ0FxUXdEd1lEVlIwVEFRSC9CQVV3QXdFQi96QU5CZ2txaGtpRzl3MEJBUXNGQUFPQ0FnRUFEMGFJCmVxckRQS2g0S0xscndxU1Z1ZVFNN3lUa1hCckozRW14dmhCM3QzTlhIWW1rME1WMG1NM0FLQklYRG1Wa2ZMalcKSHprTVJGU2pzMFRjVkRUTHhnajZaYVBKb3dkSWYwWTArb2dCcEZtL3B3bDJxSUNHUldjbWM3dVBRWkxhWjJjLwpIM3VyU2dYeGVOS283b3BRSTVuSzJKWFdHblE4LzVYV0p0WFVjR1pnb1BNeU5YRHJkT0JyVUpMWFh3djR6SmxxClBveks3VWxQeDhHNE1QZThOQWxZN3BkVmZiY21IbHhFRkN1S0kra2trajg4T2ZFNkxReXFuQ0M5NzdidmVpQW0KMUNIY3lMVUFDajI1d1hIdEV4Ync2ejdQZmxRZ3dUbGJiLzRsVjhjdi9YQ09WK3BRRkk2aWdISStyOWZxUnhKUwpjVTFXdkN1RHVKN2lLcjczWU5JblpiRHJ2ZjllcnRXQzRtV2l4NWxOQmZwdlJNVVp1R1VKNVFacUY0dnVwUW04CjNBQnRYNGNLU0s4OGFDVkQ0ZURTcy9HYy9zZ0JSeFdBNGVmRXRvbWYwV1JrZ0JiK2IrenB0RUtjVXJLU3ZOdUoKRDVtMmYyK3NNUzRQOGJoMjU2NU54WGg3Y1RZS2pDblNLTnM2Tkg5enc2cGNtaEtsQnplbHVKNEwwWDVYY0xwTApHNXNIbjNHdS9iWk9WalpBeS83T0xxaXlNeUtPSjBMRFQ3clZvRSs0ditmcXQ4QnVTbFpRTStUNGtwNytMNFo2CkIvYzhwZTFpeE9XaXZuTFBCbGpCNFprWG1wQ0ZBRXFNT0Q0WVVza0gxcVBCdEx6eElQTzJ6d2Fnb2pYUmxPY3IKcUlJVlEvZVVUYzJsZFJ0N0hZdjdLdXRlOUcyU0pKL3hFMWhkK3hrPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg=="
                host                   = "https://gpitfuturesprodaksdns-03fbe41c.hcp.uksouth.azmk8s.io:443"
                password               = "481708a9337910991e295c4f30bd698463b5a12fff91ae7ed321a890b9c851232acff58f59204f02166d63a1ead34d5f987f45707f5c3ab338251502c8841e00"
                username               = "clusterUser_gpitfutures-prod-rg-aks_gpitfutures-prod-aks"
            },
        ]
        kube_config_raw                 = (sensitive value)
        kubernetes_version              = "1.15.7"
        location                        = "uksouth"
        name                            = "gpitfutures-prod-aks"
        node_resource_group             = "gpitfutures-prod-rg-aks-pool"
        private_link_enabled            = false
        resource_group_name             = "gpitfutures-prod-rg-aks"
        tags                            = {
            "environment" = "prod"
        }

        addon_profile {

            kube_dashboard {
                enabled = true
            }

            oms_agent {
                enabled                    = true
                log_analytics_workspace_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourcegroups/gpitfutures-prod-rg-la/providers/microsoft.operationalinsights/workspaces/gpitfutures-prod-logs"
            }
        }

        agent_pool_profile {
            availability_zones    = []
            count                 = 2
            enable_auto_scaling   = true
            enable_node_public_ip = false
            fqdn                  = "gpitfuturesprodaksdns-03fbe41c.hcp.uksouth.azmk8s.io"
            max_count             = 9
            max_pods              = 30
            min_count             = 3
            name                  = "prodpool1"
            node_taints           = []
            os_disk_size_gb       = 128
            os_type               = "Linux"
            type                  = "VirtualMachineScaleSets"
            vm_size               = "Standard_F4s"
            vnet_subnet_id        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-aks"
        }

      ~ default_node_pool {
            availability_zones    = []
            enable_auto_scaling   = true
            enable_node_public_ip = false
            max_count             = 9
            max_pods              = 30
            min_count             = 3
            name                  = "prodpool1"
          ~ node_count            = 2 -> 3
            node_taints           = []
            os_disk_size_gb       = 128
            type                  = "VirtualMachineScaleSets"
            vm_size               = "Standard_F4s"
            vnet_subnet_id        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-aks"
        }

        network_profile {
            dns_service_ip     = "10.110.48.111"
            docker_bridge_cidr = "172.17.48.1/24"
            load_balancer_sku  = "Standard"
            network_plugin     = "azure"
            network_policy     = "azure"
            service_cidr       = "10.110.48.0/24"

            load_balancer_profile {
                effective_outbound_ips    = [
                    "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-aks-pool/providers/Microsoft.Network/publicIPAddresses/9f92d442-0016-4c5f-b19b-e8c6b26384e4",
                ]
                managed_outbound_ip_count = 1
                outbound_ip_address_ids   = []
                outbound_ip_prefix_ids    = []
            }
        }

        role_based_access_control {
            enabled = true
        }

        service_principal {
            client_id     = "cd7c98b2-31ca-4e02-9100-981697324ac5"
            client_secret = (sensitive value)
        }
    }

  # azurerm_management_lock.aks will be created
  + resource "azurerm_management_lock" "aks" {
      + id         = (known after apply)
      + lock_level = "CanNotDelete"
      + name       = "az_mgm_lock_aks"
      + notes      = "To prevent Production Resource Group from being deleted"
      + scope      = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-aks"
    }

  # azurerm_management_lock.ehubukw will be created
  + resource "azurerm_management_lock" "ehubukw" {
      + id         = (known after apply)
      + lock_level = "CanNotDelete"
      + name       = "az_mgm_lock_aks"
      + notes      = "To prevent Production Resource Group from being deleted"
      + scope      = (known after apply)
    }

  # azurerm_network_interface.bastion_jump_nic will be created
  + resource "azurerm_network_interface" "bastion_jump_nic" {
      + applied_dns_servers           = (known after apply)
      + dns_servers                   = (known after apply)
      + enable_accelerated_networking = false
      + enable_ip_forwarding          = false
      + id                            = (known after apply)
      + internal_dns_name_label       = (known after apply)
      + internal_fqdn                 = (known after apply)
      + location                      = "uksouth"
      + mac_address                   = (known after apply)
      + name                          = "gpitfutures-prod-bstn-nic"
      + network_security_group_id     = (known after apply)
      + private_ip_address            = (known after apply)
      + private_ip_addresses          = (known after apply)
      + resource_group_name           = "gpitfutures-prod-rg-bastion"
      + tags                          = {
          + "environment" = "prod"
        }
      + virtual_machine_id            = (known after apply)

      + ip_configuration {
          + application_gateway_backend_address_pools_ids = (known after apply)
          + application_security_group_ids                = (known after apply)
          + load_balancer_backend_address_pools_ids       = (known after apply)
          + load_balancer_inbound_nat_rules_ids           = (known after apply)
          + name                                          = "gpitfutures-prod-bstn-nic-ip"
          + primary                                       = (known after apply)
          + private_ip_address                            = (known after apply)
          + private_ip_address_allocation                 = "dynamic"
          + private_ip_address_version                    = "IPv4"
          + subnet_id                                     = (known after apply)
        }
    }

  # azurerm_network_security_group.bastion_jump will be created
  + resource "azurerm_network_security_group" "bastion_jump" {
      + id                  = (known after apply)
      + location            = "uksouth"
      + name                = "gpitfutures-prod-nsg-bst-jmp"
      + resource_group_name = "gpitfutures-prod-rg-vnet"
      + security_rule       = (known after apply)
      + tags                = {
          + "environment" = "prod"
        }
    }

  # azurerm_network_security_group.gateway_pri will be created
  + resource "azurerm_network_security_group" "gateway_pri" {
      + id                  = (known after apply)
      + location            = "uksouth"
      + name                = "gpitfutures-prod-nsg-gateway-pri"
      + resource_group_name = "gpitfutures-prod-rg-vnet"
      + security_rule       = (known after apply)
      + tags                = {
          + "environment" = "prod"
        }
    }

  # azurerm_network_security_rule.Azure will be updated in-place
  ~ resource "azurerm_network_security_rule" "Azure" {
        access                                     = "Allow"
      ~ description                                = "Allow incoming Azure Load Balancer probes (AzureLoadBalancer tag) and inbound virtual network traffic (VirtualNetwork tag) on the NSG." -> "Allow incoming Azure Gateway Manager and inbound virtual network traffic (VirtualNetwork tag) on the NSG."
        destination_address_prefix                 = "*"
        destination_address_prefixes               = []
        destination_application_security_group_ids = []
        destination_port_range                     = "65200-65535"
        destination_port_ranges                    = []
        direction                                  = "Inbound"
        id                                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowAzureInfrastructurePorts"
        name                                       = "AllowAzureInfrastructurePorts"
        network_security_group_name                = "gpitfutures-prod-nsg-gateway"
        priority                                   = 500
      ~ protocol                                   = "*" -> "TCP"
        resource_group_name                        = "gpitfutures-prod-rg-vnet"
      ~ source_address_prefix                      = "*" -> "194.101.83.0/24"
        source_address_prefixes                    = []
        source_application_security_group_ids      = []
        source_port_range                          = "*"
        source_port_ranges                         = []
    }

  # azurerm_network_security_rule.Azure_pri will be created
  + resource "azurerm_network_security_rule" "Azure_pri" {
      + access                      = "Allow"
      + description                 = "Allow incoming Azure Gateway Manager and inbound virtual network traffic (VirtualNetwork tag) on the NSG."
      + destination_address_prefix  = "*"
      + destination_port_range      = "65200-65535"
      + direction                   = "Inbound"
      + id                          = (known after apply)
      + name                        = "AllowAzureInfrastructurePorts"
      + network_security_group_name = "gpitfutures-prod-nsg-gateway-pri"
      + priority                    = 500
      + protocol                    = "TCP"
      + resource_group_name         = "gpitfutures-prod-rg-vnet"
      + source_address_prefix       = "194.101.83.0/24"
      + source_port_range           = "*"
    }

  # azurerm_network_security_rule.BJSS_pri will be created
  + resource "azurerm_network_security_rule" "BJSS_pri" {
      + access                      = "Allow"
      + description                 = "Allow staff access who are connect to the BJSS VPN"
      + destination_address_prefix  = "*"
      + destination_port_range      = "80,433"
      + direction                   = "Inbound"
      + id                          = (known after apply)
      + name                        = "AllowBjssVpn"
      + network_security_group_name = "gpitfutures-prod-nsg-gateway-pri"
      + priority                    = 160
      + protocol                    = "TCP"
      + resource_group_name         = "gpitfutures-prod-rg-vnet"
      + source_address_prefix       = "86.156.184.218"
      + source_port_range           = "*"
    }

  # azurerm_network_security_rule.BWP_pri will be created
  + resource "azurerm_network_security_rule" "BWP_pri" {
      + access                      = "Allow"
      + description                 = "Allow staff access who work within Bridgewater Place"
      + destination_address_prefix  = "*"
      + destination_port_range      = "80,433"
      + direction                   = "Inbound"
      + id                          = (known after apply)
      + name                        = "AllowBwpGovIp"
      + network_security_group_name = "gpitfutures-prod-nsg-gateway-pri"
      + priority                    = 150
      + protocol                    = "TCP"
      + resource_group_name         = "gpitfutures-prod-rg-vnet"
      + source_address_prefix       = "194.101.83.0/24"
      + source_port_range           = "*"
    }

  # azurerm_network_security_rule.DevOps will be updated in-place
  ~ resource "azurerm_network_security_rule" "DevOps" {
        access                                     = "Allow"
        description                                = "Allow AzureDevops Access to Kubernetes Cluster"
        destination_address_prefix                 = "*"
        destination_address_prefixes               = []
        destination_application_security_group_ids = []
      ~ destination_port_range                     = "*" -> "80,433"
        destination_port_ranges                    = []
        direction                                  = "Inbound"
        id                                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowAzureDevOps"
        name                                       = "AllowAzureDevOps"
        network_security_group_name                = "gpitfutures-prod-nsg-gateway"
        priority                                   = 200
      ~ protocol                                   = "*" -> "TCP"
        resource_group_name                        = "gpitfutures-prod-rg-vnet"
        source_address_prefix                      = "AzureCloud"
        source_address_prefixes                    = []
        source_application_security_group_ids      = []
        source_port_range                          = "*"
        source_port_ranges                         = []
    }

  # azurerm_network_security_rule.DevOps_pri will be created
  + resource "azurerm_network_security_rule" "DevOps_pri" {
      + access                      = "Allow"
      + description                 = "Allow AzureDevops Access to Kubernetes Cluster Private"
      + destination_address_prefix  = "*"
      + destination_port_range      = "80,433"
      + direction                   = "Inbound"
      + id                          = (known after apply)
      + name                        = "AllowAzureDevOps"
      + network_security_group_name = "gpitfutures-prod-nsg-gateway-pri"
      + priority                    = 200
      + protocol                    = "TCP"
      + resource_group_name         = "gpitfutures-prod-rg-vnet"
      + source_address_prefix       = "AzureCloud"
      + source_port_range           = "*"
    }

  # azurerm_network_security_rule.Public will be created
  + resource "azurerm_network_security_rule" "Public" {
      + access                      = "Allow"
      + description                 = "Allow public access"
      + destination_address_prefix  = "*"
      + destination_port_range      = "80,433"
      + direction                   = "Inbound"
      + id                          = (known after apply)
      + name                        = "Public"
      + network_security_group_name = "gpitfutures-prod-nsg-gateway"
      + priority                    = 160
      + protocol                    = "TCP"
      + resource_group_name         = "gpitfutures-prod-rg-vnet"
      + source_address_prefix       = "*"
      + source_port_range           = "*"
    }

  # azurerm_network_security_rule.bjss will be destroyed
  - resource "azurerm_network_security_rule" "bjss" {
      - access                                     = "Allow" -> null
      - description                                = "Allow staff access who are connect to the BJSS VPN" -> null
      - destination_address_prefix                 = "*" -> null
      - destination_address_prefixes               = [] -> null
      - destination_application_security_group_ids = [] -> null
      - destination_port_range                     = "*" -> null
      - destination_port_ranges                    = [] -> null
      - direction                                  = "Inbound" -> null
      - id                                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowBjssVpn" -> null
      - name                                       = "AllowBjssVpn" -> null
      - network_security_group_name                = "gpitfutures-prod-nsg-gateway" -> null
      - priority                                   = 160 -> null
      - protocol                                   = "*" -> null
      - resource_group_name                        = "gpitfutures-prod-rg-vnet" -> null
      - source_address_prefix                      = "148.253.134.213" -> null
      - source_address_prefixes                    = [] -> null
      - source_application_security_group_ids      = [] -> null
      - source_port_range                          = "*" -> null
      - source_port_ranges                         = [] -> null
    }

  # azurerm_network_security_rule.bwp will be destroyed
  - resource "azurerm_network_security_rule" "bwp" {
      - access                                     = "Allow" -> null
      - description                                = "Allow staff access who work within Bridgewater Place" -> null
      - destination_address_prefix                 = "*" -> null
      - destination_address_prefixes               = [] -> null
      - destination_application_security_group_ids = [] -> null
      - destination_port_range                     = "*" -> null
      - destination_port_ranges                    = [] -> null
      - direction                                  = "Inbound" -> null
      - id                                         = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway/securityRules/AllowBwpGovIp" -> null
      - name                                       = "AllowBwpGovIp" -> null
      - network_security_group_name                = "gpitfutures-prod-nsg-gateway" -> null
      - priority                                   = 150 -> null
      - protocol                                   = "*" -> null
      - resource_group_name                        = "gpitfutures-prod-rg-vnet" -> null
      - source_address_prefix                      = "194.101.82.0/24" -> null
      - source_address_prefixes                    = [] -> null
      - source_application_security_group_ids      = [] -> null
      - source_port_range                          = "*" -> null
      - source_port_ranges                         = [] -> null
    }

  # azurerm_public_ip.bastion will be created
  + resource "azurerm_public_ip" "bastion" {
      + allocation_method            = "Static"
      + fqdn                         = (known after apply)
      + id                           = (known after apply)
      + idle_timeout_in_minutes      = 4
      + ip_address                   = (known after apply)
      + ip_version                   = "IPv4"
      + location                     = "uksouth"
      + name                         = "gpitfutures-prod-bastion-pip"
      + public_ip_address_allocation = (known after apply)
      + resource_group_name          = "gpitfutures-prod-rg-bastion"
      + sku                          = "Standard"
      + tags                         = (known after apply)
    }

  # azurerm_resource_group.bastion will be created
  + resource "azurerm_resource_group" "bastion" {
      + id       = (known after apply)
      + location = "uksouth"
      + name     = "gpitfutures-prod-rg-bastion"
      + tags     = {
          + "environment" = "prod"
        }
    }

  # azurerm_resource_group.ehubukw will be created
  + resource "azurerm_resource_group" "ehubukw" {
      + id       = (known after apply)
      + location = "ukwest"
      + name     = "gpitfutures-prod-rg-ehub-ukw"
      + tags     = (known after apply)
    }

  # azurerm_sql_server.bc-sql-pri will be updated in-place
  ~ resource "azurerm_sql_server" "bc-sql-pri" {
        administrator_login          = "gpitfutureadmin"
        administrator_login_password = (sensitive value)
        fully_qualified_domain_name  = "gpitfutures-prod-sql-pri.database.windows.net"
        id                           = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-pri/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-pri"
        location                     = "uksouth"
        name                         = "gpitfutures-prod-sql-pri"
        resource_group_name          = "gpitfutures-prod-rg-sql-pri"
        tags                         = {}
        version                      = "12.0"

      - identity {
          - principal_id = "e88a10cd-3931-4322-8e3f-4d6d9c0bcfe8" -> null
          - tenant_id    = "50f6071f-bbfe-401a-8803-673748e629e2" -> null
          - type         = "SystemAssigned" -> null
        }
    }

  # azurerm_sql_server.bc-sql-sec will be updated in-place
  ~ resource "azurerm_sql_server" "bc-sql-sec" {
        administrator_login          = "gpitfutureadmin"
        administrator_login_password = (sensitive value)
        fully_qualified_domain_name  = "gpitfutures-prod-sql-sec.database.windows.net"
        id                           = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-sql-sec/providers/Microsoft.Sql/servers/gpitfutures-prod-sql-sec"
        location                     = "ukwest"
        name                         = "gpitfutures-prod-sql-sec"
        resource_group_name          = "gpitfutures-prod-rg-sql-sec"
        tags                         = {}
        version                      = "12.0"

      - identity {
          - principal_id = "bed6ab48-e56c-4f58-83b0-5f7125f7ea67" -> null
          - tenant_id    = "50f6071f-bbfe-401a-8803-673748e629e2" -> null
          - type         = "SystemAssigned" -> null
        }
    }

  # azurerm_subnet.bastion must be replaced
-/+ resource "azurerm_subnet" "bastion" {
      ~ address_prefix                                 = "10.100.50.0/24" -> "10.100.50.0/27"
        enforce_private_link_endpoint_network_policies = false
        enforce_private_link_service_network_policies  = false
      ~ id                                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-bastion" -> (known after apply)
      ~ ip_configurations                              = [] -> (known after apply)
      ~ name                                           = "gpitfutures-prod-sub-bastion" -> "AzureBastionSubnet" # forces replacement
        resource_group_name                            = "gpitfutures-prod-rg-vnet"
      - service_endpoints                              = [] -> null
        virtual_network_name                           = "gpitfutures-prod-vnet"
    }

  # azurerm_subnet.bastion_jump will be created
  + resource "azurerm_subnet" "bastion_jump" {
      + address_prefix                                 = "10.100.55.0/24"
      + enforce_private_link_endpoint_network_policies = false
      + enforce_private_link_service_network_policies  = false
      + id                                             = (known after apply)
      + ip_configurations                              = (known after apply)
      + name                                           = "gpitfutures-prod-sub-bst-jmp"
      + resource_group_name                            = "gpitfutures-prod-rg-vnet"
      + virtual_network_name                           = "gpitfutures-prod-vnet"
    }

  # azurerm_subnet.gateway will be updated in-place
  ~ resource "azurerm_subnet" "gateway" {
        address_prefix                                 = "10.100.48.0/28"
        enforce_private_link_endpoint_network_policies = false
        enforce_private_link_service_network_policies  = false
        id                                             = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway"
        ip_configurations                              = []
        name                                           = "gpitfutures-prod-sub-gateway"
      - network_security_group_id                      = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway" -> null
        resource_group_name                            = "gpitfutures-prod-rg-vnet"
        service_endpoints                              = []
        virtual_network_name                           = "gpitfutures-prod-vnet"
    }

  # azurerm_subnet.gateway_pri will be created
  + resource "azurerm_subnet" "gateway_pri" {
      + address_prefix                                 = "10.100.54.0/28"
      + enforce_private_link_endpoint_network_policies = false
      + enforce_private_link_service_network_policies  = false
      + id                                             = (known after apply)
      + ip_configurations                              = (known after apply)
      + name                                           = "gpitfutures-prod-sub-gateway-pri"
      + resource_group_name                            = "gpitfutures-prod-rg-vnet"
      + virtual_network_name                           = "gpitfutures-prod-vnet"
    }

  # azurerm_subnet_network_security_group_association.bastion_jump_subnet_assoc will be created
  + resource "azurerm_subnet_network_security_group_association" "bastion_jump_subnet_assoc" {
      + id                        = (known after apply)
      + network_security_group_id = (known after apply)
      + subnet_id                 = (known after apply)
    }

  # azurerm_subnet_network_security_group_association.gateway will be destroyed
  - resource "azurerm_subnet_network_security_group_association" "gateway" {
      - id                        = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway" -> null
      - network_security_group_id = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/networkSecurityGroups/gpitfutures-prod-nsg-gateway" -> null
      - subnet_id                 = "/subscriptions/d1be8dbc-1a9f-4b7b-ba51-037116110e00/resourceGroups/gpitfutures-prod-rg-vnet/providers/Microsoft.Network/virtualNetworks/gpitfutures-prod-vnet/subnets/gpitfutures-prod-sub-gateway" -> null
    }

  # azurerm_template_deployment.bc-sql-pri-retention will be created
  + resource "azurerm_template_deployment" "bc-sql-pri-retention" {
      + deployment_mode     = "Incremental"
      + id                  = (known after apply)
      + name                = "bc-sql-pri-retention"
      + outputs             = (known after apply)
      + resource_group_name = "gpitfutures-prod-rg-sql-pri"
      + template_body       = jsonencode(
            {
              + $schema        = "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"
              + contentVersion = "1.0.0.0"
              + resources      = [
                  + {
                      + apiVersion = "2017-03-01-preview"
                      + name       = "gpitfutures-prod-sql-pri/gpitfutures-prod-db-bapi-public/default"
                      + properties = {
                          + monthlyRetention = "P12W"
                          + weekOfYear       = "17"
                          + weeklyRetention  = "P6W"
                          + yearlyRetention  = "P7Y"
                        }
                      + type       = "Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies"
                    },
                  + {
                      + apiVersion = "2017-10-01-preview"
                      + name       = "gpitfutures-prod-sql-pri/gpitfutures-prod-db-bapi-public/default"
                      + properties = {
                          + retentionDays = 14
                        }
                      + type       = "Microsoft.Sql/servers/databases/backupShortTermRetentionPolicies"
                    },
                  + {
                      + apiVersion = "2017-03-01-preview"
                      + name       = "gpitfutures-prod-sql-pri/gpitfutures-prod-db-bapi-private/default"
                      + properties = {
                          + monthlyRetention = "P12W"
                          + weekOfYear       = "17"
                          + weeklyRetention  = "P6W"
                          + yearlyRetention  = "P7Y"
                        }
                      + type       = "Microsoft.Sql/servers/databases/backupLongTermRetentionPolicies"
                    },
                  + {
                      + apiVersion = "2017-10-01-preview"
                      + name       = "gpitfutures-prod-sql-pri/gpitfutures-prod-db-bapi-private/default"
                      + properties = {
                          + retentionDays = 14
                        }
                      + type       = "Microsoft.Sql/servers/databases/backupShortTermRetentionPolicies"
                    },
                ]
            }
        )
    }

  # azurerm_virtual_machine.jump will be created
  + resource "azurerm_virtual_machine" "jump" {
      + availability_set_id              = (known after apply)
      + delete_data_disks_on_termination = false
      + delete_os_disk_on_termination    = true
      + id                               = (known after apply)
      + license_type                     = (known after apply)
      + location                         = "uksouth"
      + name                             = "gpitfutures-prod-jump"
      + network_interface_ids            = (known after apply)
      + resource_group_name              = "gpitfutures-prod-rg-bastion"
      + tags                             = {
          + "environment" = "prod"
        }
      + vm_size                          = "Standard_B1ms"

      + boot_diagnostics {
          + enabled = false
        }

      + identity {
          + identity_ids = (known after apply)
          + principal_id = (known after apply)
          + type         = (known after apply)
        }

      + os_profile {
          + admin_password = (sensitive value)
          + admin_username = "gpitfurebastionadmin"
          + computer_name  = "Jump"
          + custom_data    = (known after apply)
        }

      + os_profile_windows_config {
          + enable_automatic_upgrades = true
          + provision_vm_agent        = true
        }

      + storage_data_disk {
          + caching                   = (known after apply)
          + create_option             = (known after apply)
          + disk_size_gb              = (known after apply)
          + lun                       = (known after apply)
          + managed_disk_id           = (known after apply)
          + managed_disk_type         = (known after apply)
          + name                      = (known after apply)
          + vhd_uri                   = (known after apply)
          + write_accelerator_enabled = (known after apply)
        }

      + storage_image_reference {
          + offer     = "Windows-10"
          + publisher = "MicrosoftWindowsDesktop"
          + sku       = "rs5-pro"
          + version   = "latest"
        }

      + storage_os_disk {
          + caching                   = "ReadWrite"
          + create_option             = "FromImage"
          + disk_size_gb              = (known after apply)
          + managed_disk_id           = (known after apply)
          + managed_disk_type         = "Standard_LRS"
          + name                      = "disk1"
          + os_type                   = "Windows"
          + write_accelerator_enabled = false
        }
    }

Plan: 26 to add, 8 to change, 4 to destroy.

------------------------------------------------------------------------

Note: You didn't specify an "-out" parameter to save this plan, so Terraform
can't guarantee that exactly these actions will be performed if
"terraform apply" is subsequently run.

